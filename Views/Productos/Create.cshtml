@model MyPymeStore.Models.Producto
@using Microsoft.AspNetCore.Mvc.Rendering

<h2>Agregar Producto</h2>

<form asp-action="Create" method="post">
    <!-- Nombre -->
    <div class="form-group mb-3">
        <label asp-for="Nombre"></label>
        <input asp-for="Nombre" class="form-control" required />
        <span asp-validation-for="Nombre" class="text-danger"></span>
    </div>

    <!-- Precio -->
    <div class="form-group mb-3">
        <label asp-for="Precio"></label>
        <input asp-for="Precio" id="precio" class="form-control" step="0.01" required min="0.01" />
        <span asp-validation-for="Precio" class="text-danger"></span>
    </div>

    <!-- IVA en porcentaje -->
    <div class="form-group mb-3">
        <label>IVA (%)</label>
        <input type="number" id="ivaPorcentaje" class="form-control" value="13" min="0" max="100" />
    </div>

    <!-- Total -->
    <div class="form-group mb-3">
        <label>Total</label>
        <input type="text" id="total" class="form-control" readonly />
    </div>

    <!-- Stock -->
    <div class="form-group mb-3">
        <label asp-for="Stock"></label>
        <input asp-for="Stock" class="form-control" required min="0" />
        <span asp-validation-for="Stock" class="text-danger"></span>
    </div>

    <!-- Categoría -->
    <div class="form-group mb-3">
        <label asp-for="CategoriaId">Categoría</label>
        <select asp-for="CategoriaId" class="form-control" asp-items="ViewBag.CategoriasSelectList" required>
            <option value="">-- Selecciona una categoría --</option>
        </select>
        <span asp-validation-for="CategoriaId" class="text-danger"></span>
    </div>

    <!-- Imagen -->
    <div class="form-group mb-3">
        <label asp-for="ImagenUrl">URL de Imagen</label>
        <input asp-for="ImagenUrl" class="form-control" />
    </div>

    <!-- Activo -->
    <div class="form-check mb-3">
        <input asp-for="Activo" class="form-check-input" type="checkbox" />
        <label asp-for="Activo" class="form-check-label">Activo</label>
    </div>

    <button type="submit" class="btn btn-success mt-2">Guardar</button>
</form>

@section Scripts {
    <script>
        const precioInput = document.getElementById('precio');
        const ivaInput = document.getElementById('ivaPorcentaje');
        const totalInput = document.getElementById('total');

        function actualizarTotal() {
            const precio = parseFloat(precioInput.value) || 0;
            const ivaPorc = parseFloat(ivaInput.value) || 0;
            const ivaValor = precio * (ivaPorc / 100);
            totalInput.value = (precio + ivaValor).toFixed(2);
        }

        precioInput.addEventListener('input', actualizarTotal);
        ivaInput.addEventListener('input', actualizarTotal);

        // Inicializa al cargar la página
        actualizarTotal();
    </script>
}

